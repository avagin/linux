language: c
sudo: required
dist: trusty
cache: ccache
env:
  global:
    - secure: "fWbChZ9m2MDIEFARNxXxHyfsspplFYtfzVVzycB1lvfD5MwUUX4c8ezpE1U5/Ao2Qh1EIJgK4zHcO+G0kUeXZYCXpG2SxF5XmUIFdGquT4INkuMQ7AErLrGfMA3qa2EfIvVpKM8wb2xV3DywUCmh5Q0l4YrhR1s8xClUJnnBk6I="
install:
  - sudo apt-get update
  - sudo apt-get install -qq --no-install-recommends protobuf-c-compiler libprotobuf-c0-dev libaio-dev libprotobuf-dev protobuf-compiler python-ipaddr libcap-dev libnl-3-dev gcc-multilib libc6-dev-i386 gdb bash python-protobuf libnet-dev util-linux asciidoc xmlto libnl-route-3-dev kexec-tools libssl-dev libelf-dev strace ccache
jobs:
  include:
    - stage: kernel
      script: sudo ./scripts/travis-ci kernel
      env:
        - KASAN=0
    - stage: kernel
      script: sudo ./scripts/travis-ci kernel
      env:
        - KASAN=1
    - stage: zdtm
      script: sudo ./scripts/travis-ci local
      env:
        - KASAN=0
    - stage: zdtm
      script: sudo ./scripts/travis-ci local
      env:
        - KASAN=1
stages:
  - kernel
  - zdtm
after_failure:
  - sudo dmesg
group: deprecated-2017Q2
